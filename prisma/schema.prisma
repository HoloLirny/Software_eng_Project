generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model user {
  id        Int             @id @default(autoincrement())
  user_name String
  email     String          @unique(map: "User_email_key")
  phone     String          @unique(map: "User_phone_key")
  password  String
  user_role user_user_role? @default(TEACHER)
  courses   course[]
}

model student {
  id              Int              @id
  faculty         String           @db.VarChar(255)
  student_name    String           @db.VarChar(255)
  attendances     attendance[]
  course_students course_student[]
}

model course_student {
  id         Int     @id @default(autoincrement())
  course_id  Int
  student_id Int
  course     course  @relation(fields: [course_id], references: [id])
  student    student @relation(fields: [student_id], references: [id])

  @@index([course_id], map: "course_student_course_id_fkey")
  @@index([student_id], map: "course_student_student_id_fkey")
}

model course {
  id              Int              @id
  course_name     String           @db.VarChar(255)
  teacher_id      Int
  total_student   Int
  scan_time       DateTime?
  attendances     attendance[]
  teacher         user             @relation(fields: [teacher_id], references: [id])
  course_students course_student[]

  @@index([teacher_id], map: "course_teacher_id_fkey")
}

model attendance {
  id         Int               @id @default(autoincrement())
  student_id Int
  course_id  Int
  date       DateTime
  time       DateTime
  status     attendance_status @default(PRESENT)
  course     course            @relation(fields: [course_id], references: [id])
  student    student           @relation(fields: [student_id], references: [id])

  @@index([course_id], map: "attendance_course_id_fkey")
  @@index([student_id], map: "attendance_student_id_fkey")
}

enum attendance_status {
  PRESENT
  ABSENT
  LATE
}

enum user_user_role {
  ADMIN
  TEACHER
  TA
}
